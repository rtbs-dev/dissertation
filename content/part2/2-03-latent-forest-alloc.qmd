# LFA: Latent Forest Allocation  

## LFA as Factorization 

### Dictionary Learning

### Interaction Degree, not Binary
- "plan" from avrachenkov


## Generative Model Specification {#sec-lfa-like}

![Explanation of the Random Spanning Forest generative model for binary activation observations](../images/random-spanning-forests.png)
- hierarchical model
- marginalize over the root node. 


## Bayesian Estimation by Gibbs Sampling {#sec-lfa-gibbs} 

### Uniform Random Spanning Trees
- Methods for sampling i.e. wilson's and Duan's (other? Energy paper?)
- Tree Likelihoods, other facts (edge expectations)

### Approximate Forest Samples
- comparison with LDA
- Simplifying Assumptions (conditional prob IS prob for this)

  I.e. the unwritten paper, modifying technique by @BayesianSpanningTree_Duan2021 for RSF instead of RSTs

## Expected Forest Maximization {#sec-lfa-efm}

### Alternating Directions
- estimate laplacian to get $Q_i$ as shortest path distance

### degree normalization
sym laplacian before forest kernel

### algorithm overview

## Simulation Study

### Score Improvement
{{< embed ../codefigs/results.qmd#fig-efm-mcc  >}}

### Odds of Individual Edge Improvement 
{{< embed ../codefigs/results.qmd#fig-efm-logits  >}}

### Runtime Cost

{{< embed ../codefigs/results.qmd#fig-efm-runtime >}}

{{< embed ../codefigs/results.qmd#fig-efm-partials-runtime >}}
